{% extends 'layout-nav.html' %}
{% set pageSection = "Manage user notifications" %}

<!-- this page is only visible to prod-accessreport group -->

{% block beforeContent %}
<nav class="nhsuk-breadcrumb" aria-label="Breadcrumb">
    <div class="nhsuk-width-container">
      <ol class="nhsuk-breadcrumb__list">
        <li class="nhsuk-breadcrumb__item"><a class="nhsuk-breadcrumb__link" href="/notifications">Manage user notifications</a></li>
        <li class="nhsuk-breadcrumb__item"><a class="nhsuk-breadcrumb__link" href="/notifications/user-alerts/manage-user-alerts">Manage user alerts</a></li>
        <li class="nhsuk-breadcrumb__item">Edit active user alert</li>
      </ol>
    </div>
  </nav>
{% endblock %}

{% block headCSS %}
  <link href="/css/main.css" rel="stylesheet">
  <link href="/css/nhsuk.css" rel="stylesheet">


{% endblock %}

{% block content %}

<style>

	a:visited { 
	  color:	#005eb8; 
	  }
	
	.inp-wrapper {
	  display: flex;
	  gap:32px;
	}

	label {
	  color: #212b32;
	  display: block;
	}	

	.dateend {
	  font-size: 19px;
	  width:240px;
	  padding: 16px;
	  color: #212b32;
	  border:transparent solid 2px;
	  outline: transparent solid 2px;
	  border-radius: 0.2em;
	  margin-top: 0.6em;
	  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
	}

	.dateend.default {
	  font-size: 19px;
	  width:240px;
	  padding: 16px;
	  color: #212b32;
	  border:transparent solid 2px;
	  outline: transparent solid 2px;
	  border-radius: 0.2em;
	  margin-top: 0.6em;
	  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
	}

	.dateend:focus{
		border: 2px solid 	#212b32;
		  outline: 2px solid 	#ffeb3b;
	}



	::-webkit-calendar-picker-indicator {
	  background-color: #d8dde0;
	  padding: 0.2em;
	  cursor: pointer;
	  border-radius: 0.1em;
	  
	}
.dates {
  display: none;
  background-color: #FFF;
  width: 360px;
  height: 300px;
  margin-top: 24px;
  margin-bottom: 24px;
  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
}



.dates .month {
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 2px solid 	#d8dde0;
  color: #1a8fff;
  font-size: 22px;
  font-weight: 600;
  padding-top: 8px;
  padding-bottom: 8px;
  
}

.dates .month .arrows {
	width: 40px;
	height:40px;
	display: flex;
	justify-content: center;
	align-items: center;
	color: #212b32;
	font-size: 24px;
}

.dates .month .arrows:hover {
  background-color: #b3daff;
  color: #212b32;
}

.dates .month .arrows:active {
  background-color: #b3daff;
  color: #212b32;
}

.dates .days {
	display: grid;
	grid-template-columns: repeat(7, 1fr);
	height: 200px;
	width: 100%;
	cursor: pointer;
	box-shadow: none;
}

.dates .days .day { 
	display: flex;
	justify-content: center;
	align-items: center;
	color: #212b32;
	font-size:19px;
}


.dates .days .day:hover {
	background-color: #b3daff;
	color: #005eb8;
}


.dates .days .day.selected {
	background-color: #1a8fff;
	color:#FFF;
}


.dates .days .day.selected:hover {
	background-color: #1a8fff;
	color:#FFF;
}


.timeend {
	  font-size: 19px;
	  text-align: center;
	  width:132px;
	  padding: 16px;
	  color: #212b32;
	  border:transparent solid 2px;
	  outline: transparent solid 2px;
	  border-radius: 0.2em;
	  margin-top: 0.6em;
	  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
	}

	.timeend.default {
	  font-size: 19px;
	  text-align: center;
	  width:132px;
	  padding: 1em;
	  color: #212b32;
	  border:transparent solid 2px;
	  outline: transparent solid 2px;
	  border-radius: 0.2em;
	  margin-top: 0.6em;
	  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
	}

	.timeend:focus{
		border: 2px solid 	#212b32;
		  outline: 2px solid 	#ffeb3b;
	}

.times {
  background-color: #FFF;
  margin-left:272px;
  margin-top: 24px;
  margin-bottom: 24px;
  width: 240px;
  max-height: 300px;
  overflow-y: scroll;
  display:flex;
  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 5px 0px, rgba(0, 0, 0, 0.1) 0px 0px 1px 0px;
}

.hours {
	margin:16px;
	margin-top:0px;
	padding-top:16px;
	display: grid;
	grid-template-columns: repeat(1, 1fr);
	cursor: pointer;
	height:0%;
}

.hour{
	width:72px;
	padding:8px;
	margin:4px;
	display: flex;
	justify-content: center;
	align-items: center;
	color: #212b32;
	font-size:19px;
	background-color: #fff;
	border: 1px solid transparent;
	border-radius: 0.2em;
}

.hour:hover{
	width:72px;
	padding:8px;
	margin:4px;
	display: flex;
	justify-content: center;
	align-items: center;
	color: #005eb8;
	font-size:19px;
	background-color: #b3daff;
	border: 1px solid #b3daff;
	border-radius: 0.2em;
}

.am{
	background-color: #fff;
	color:#768692;
	border: 1px solid #d8dde0;
	font-size: 19px;
	padding:16px;
	border-radius: 0.2em;
	width: 72px;
	position: absolute;
	margin-top: 80px;
	cursor:pointer;
}

.am-selected{
	background-color: #1a8fff;
	color:#fff;
	border: none;
	font-size: 19px;
	font-weight:900;
	padding: 16px;
	border-radius: 0.2em;
	width: 72px;
	position: absolute;
	margin-top: 80px;
}

.pm{
	margin-top:16px;
	background-color: #fff;
	color:#768692;
	border: 1px solid #d8dde0;
	font-size: 19px;
	padding:16px;
	border-radius: 0.2em;
	width: 72px;
	position: absolute;
	margin-bottom: 96px;
	cursor:pointer;
}

.pm-selected{
	margin-top:16px;
	background-color: #1a8fff;
	color:#fff;
	border: none;
	font-size: 19px;
	font-weight:900;
	padding: 16px;
	border-radius: 0.2em;
	width: 72px;
	position: absolute;
	margin-bottom: 96px;
}

.time-picker-done-button{
	display:none; 
	height: 0px; 
	width: 240px; 
	background-color:#fff; 
	position:absolute; 
	margin-left:272px; 
	font-size:19px; 
	text-align: right; 
	padding-right: 36px; 
	padding-top: 16px;
}
	
</style>

<div class="nhsuk-width-container">
	<h1 class="nhsuk-heading-s nhsuk-u-padding-bottom-2" style="color: 	#4c6272;">NAM incident</h1>
</div>

  

<div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds ">
		{% if data['do-you-know-end-date-time'] === 'both' %}
        <h1 class="nhsuk-heading-l">When does the maintenance end?</h1>
		{% endif %}
		{% if data['do-you-know-end-date-time'] === 'date' %}
		<h1 class="nhsuk-heading-l">When does the maintenance end?</h1>
		{% endif %}
    </div>
</div>

<div class="nhsuk-grid-row ">
	<div class="nhsuk-grid-column-two-thirds" >
	  <p class="nhsuk-hint">
		This will be displayed on user alerts
	  </p>
	</div>
</div> 


<div class="nhsuk-grid-row nhsuk-u-margin-top-2">
	<div class="nhsuk-grid-column-full">


		<div class="inp-wrapper" id="date-time-field">
			<div class="date-wrapper" id="date">
				<label class="nhsuk-label" for="date">Date</label>
				<input class="selected-date dateend" type="text" placeholder="DD/MM/YYYY" id="dateinput"/> 
	
			</div>
	
			{% if data['do-you-know-end-date-time'] === 'both' %}
	
			<div class="time-wrapper" id="time" >
				<label class="nhsuk-label" for="date">Time</label>
				<input class="timeend" placeholder="--:--" id="timeinput"/>
			</div>
			{% endif %}
			
		</div>
	{% if data['do-you-know-end-date-time'] === 'both' %}
	<div style="width:50%" >

		<div class="time-picker-done-button" id="time-picker-done-div">
			<a style="cursor:pointer;" id="time-picker-done-button">Done</a>
		</div>

		<div class="times nhsuk-u-margin-top-4" id="timepicker" style="display:none;">
			
			<div class="hours" style="width:50%;" id="hour">
				<p class="hour">12:00</p><p class="hour">12:30</p><p class="hour">1:00</p><p class="hour">1:30</p><p class="hour">2:00</p>
				<p class="hour">2:30</p><p class="hour">3:00</p><p class="hour">3:30</p><p class="hour">4:00</p><p class="hour">4:30</p>
				<p class="hour">5:00</p><p class="hour">5:30</p><p class="hour">6:00</p><p class="hour">6:30</p><p class="hour">7:00</p><p class="hour">7:30</p>
				<p class="hour">8:00</p><p class="hour">8:30</p><p class="hour">9:00</p><p class="hour">9:30</p><p class="hour">10:00</p><p class="hour">10:30</p>
				<p class="hour">11:00</p><p class="hour">11:30</p>
			</div>	

			<div style="width:50%; height: 300px;">
				<div style="height: 150px;">
				<button class="am-selected" id="am" onclick="amButton()">AM</button>
				</div>
				<div style="height: 150px;">
				<button class="pm" id="pm" onclick="pmButton()">PM</button>
				</div>
			</div>


			
			
		</div>
		
	</div>
	{% endif %}
	<div style="width:50%">
		<div class="dates nhsuk-u-margin-top-4" id="calendar" style="display:none;">
			<div class="month">
			  <div class="arrows prev-mth">&lt;</div>
			  <div class="mth"></div>
			  <div class="arrows next-mth">&gt;</div>
			</div>
		
			<div id="date-selected" class="days dates"></div>
		</div>
	</div>	
		
	</div>	

	
</div>



<div class="nhsuk-grid-row nhsuk-u-margin-top-4">
	<div class="nhsuk-grid-column-two-thirds">
		<form action="incident-details?change=true" method="post">
			<button class="nhsuk-button" type="submit">
			  Continue with changes
			</button>
		  </form>
	
		  <p>
			<a class="nhsuk-link" href="incident-details?edit=false">
			Cancel changes and return to incident details 
			</a>
		  </p>
	</div>
</div>

<div class="nhsuk-back-link nhsuk-u-margin-top-4">
	<a class="nhsuk-back-link__link" href="#">
	  <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
		<path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
	  </svg>
	  Back to: Do you know when the maintenance ends?
	</a>
</div>

<script>
	
	const calendar = document.getElementById("calendar");
	const date1 = document.getElementById("dateinput");
	const btn3 = document.getElementById("date-selected");
	const input2 = document.getElementById("timeinput");
	const time = document.getElementById("timepicker");
	const doneButtonDiv = document.getElementById("time-picker-done-div");
	const doneButton = document.getElementById("time-picker-done-button");
	const btn4 = document.getElementById("hour");
	
	date1.onclick = function () {
		calendar.style.display = "block";
	};
	
	btn3.onclick = function () {
	  calendar.style.display = "none";
	  document.getElementById("dateinput").value ='02/02/2022'
	};

	btn4.onclick = function () {
	document.getElementById('time-selected').classList.add("hour-selected");
	if (document.getElementById("pm").className !== "pm-selected") {
	document.getElementById("timeinput").value ='1.30 AM';
	} else {
	document.getElementById("timeinput").value ='1.30 PM';
	}
	};

	doneButton.onclick = function () {
	time.style.display = "none";
	doneButtonDiv.style.display = "none";
	if (document.getElementById("pm").className !== "pm-selected") {
	document.getElementById("timeinput").value ='1.30 AM';
	} else {
	document.getElementById("timeinput").value ='1.30 PM';
	}
	};
	
	input2.onclick = function () {
	  if (time.style.display !== "none") {
		time.style.display = "none";
		document.getElementById("timeinput").value ='--:--';
	  } else {
		time.style.display = "flex";
		document.getElementById("timeinput").value =' ';
	  }

	  if (doneButtonDiv.style.display !== "none") {
		doneButtonDiv.style.display = "none";
	  } else {
		doneButtonDiv.style.display = "block";
	  }
	  
	};

	function amButton() {

	var am = document.getElementById("am");
  	var pm = document.getElementById("pm");

  	document.getElementById("am").className = "am-selected";
  	document.getElementById("pm").className = "pm";
	if (document.getElementById("timeinput").value !== " ") {
	document.getElementById("timeinput").value ='1.30 AM'
	}
	};

	function pmButton() {

	var am = document.getElementById("am");
  	var pm = document.getElementById("pm");

  	document.getElementById("am").className = "am";
  	document.getElementById("pm").className = "pm-selected";
	if (document.getElementById("timeinput").value !== " ") {
	document.getElementById("timeinput").value ='1.30 PM'
	}
	};

	document.addEventListener('mouseup', function(e) {
    if (!calendar.contains(e.target)) {
        calendar.style.display = 'none';
    }
	});

	document.addEventListener('mouseup', function(e) {
    if (!time.contains(e.target)) {
        time.style.display = 'none';
		doneButtonDiv.style.display = 'none';
    }
	});
</script>
	
	
	<script>
	
	
		const date_picker_element = document.querySelector('.date-wrapper');
		const selected_date_element = document.querySelector('.selected-date');
		const dates_element = document.querySelector('.dates');
		const mth_element = document.querySelector('.dates .month .mth');
		const next_mth_element = document.querySelector('.dates .month .next-mth');
		const prev_mth_element = document.querySelector('.dates .month .prev-mth');
		const days_element = document.querySelector('.dates .days');
		
		
		
		const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
		
		let date = new Date();
		let day = date.getDate();
		let month = date.getMonth();
		let year = date.getFullYear();
		
		let selectedDate = date;
		let selectedDay = day;
		let selectedMonth = month;
		let selectedYear = year;
		
		mth_element.textContent = months[month] + ' ' + year;
		
		selected_date_element.textContent = formatDate(date);
		selected_date_element.dataset.value = selectedDate;
		
		populateDates();
		
		// EVENT LISTENERS
		date_picker_element.addEventListener('click', toggleDatePicker);
		next_mth_element.addEventListener('click', goToNextMonth);
		prev_mth_element.addEventListener('click', goToPrevMonth);
		
		// FUNCTIONS
		function toggleDatePicker (e) {
			if (!checkEventPathForClass(e.path, 'dates')) {
				dates_element.classList.toggle('active');
			selected_date_element.classList.toggle('active');
			}
		}
		
		function goToNextMonth (e) {
			month++;
			if (month > 11) {
				month = 0;
				year++;
			}
			mth_element.textContent = months[month] + ' ' + year;
			populateDates();
		}
		
		function goToPrevMonth (e) {
			month--;
			if (month < 0) {
				month = 11;
				year--;
			}
			mth_element.textContent = months[month] + ' ' + year;
			populateDates();
		}
		
		function populateDates (e) {
			days_element.innerHTML = '';
			let amount_days = 31;
			if (month == 1) {
				amount_days = 28;
			}
		
			for (let i = 0; i < amount_days; i++) {
				const day_element = document.createElement('div');
				day_element.classList.add('day');
				day_element.textContent = i + 1;
		
				if (selectedDay == (i + 1) && selectedYear == year && selectedMonth == month) {
					day_element.classList.add('selected');
				}
		
				day_element.addEventListener('click', function () {
					selectedDate = new Date(year + '-' + (month + 1) + '-' + (i + 1));
					selectedDay = (i + 1);
					selectedMonth = month;
					selectedYear = year;
		
					selected_date_element.textContent = formatDate(selectedDate);
					selected_date_element.dataset.value = selectedDate;
		
					populateDates();
				});
		
				days_element.appendChild(day_element);
			}
		}
		
		// HELPER FUNCTIONS
		function checkEventPathForClass (path, selector) {
			for (let i = 0; i < path.length; i++) {
				if (path[i].classList && path[i].classList.contains(selector)) {
					return true;
				}
			}
			
			return false;
		}
		function formatDate (d) {
			let day = d.getDate();
			if (day < 10) {
				day = '0' + day;
			}
		
			let month = d.getMonth() + 1;
			if (month < 10) {
				month = '0' + month;
			}
		
			let year = d.getFullYear();
		
			return day + ' / ' + month + ' / ' + year;
		}
		
		
	</script>


        
{% endblock %}


